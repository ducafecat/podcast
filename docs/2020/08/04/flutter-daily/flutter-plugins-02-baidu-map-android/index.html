<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Flutter 混合开发 - 02 百度地图定位功能 android 篇 | duCafeCat</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="flutter">
    <meta name="description" content="本节目标 百度地图业务 百度组件初始 编写定位代码 android 篇  视频代码https://github.com/ducafecat/flutter_baidu_plugin_ducafecat/releases/tag/v1.0.2 正文创建组件的几种方式现成轮子直接用 官方仓库搜索 https://pub.dev/flutter/packages https://pub.flutter-">
<meta name="keywords" content="flutter">
<meta property="og:type" content="article">
<meta property="og:title" content="Flutter 混合开发 - 02 百度地图定位功能 android 篇">
<meta property="og:url" content="https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/index.html">
<meta property="og:site_name" content="duCafeCat">
<meta property="og:description" content="本节目标 百度地图业务 百度组件初始 编写定位代码 android 篇  视频代码https://github.com/ducafecat/flutter_baidu_plugin_ducafecat/releases/tag/v1.0.2 正文创建组件的几种方式现成轮子直接用 官方仓库搜索 https://pub.dev/flutter/packages https://pub.flutter-">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/2020-08-06-16-27-33.png">
<meta property="og:image" content="https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/2020-08-06-16-29-26.png">
<meta property="og:image" content="https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/2020-08-06-16-27-07.png">
<meta property="og:image" content="https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/2020-08-06-16-30-34.png">
<meta property="og:updated_time" content="2020-08-06T10:00:28.722Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Flutter 混合开发 - 02 百度地图定位功能 android 篇">
<meta name="twitter:description" content="本节目标 百度地图业务 百度组件初始 编写定位代码 android 篇  视频代码https://github.com/ducafecat/flutter_baidu_plugin_ducafecat/releases/tag/v1.0.2 正文创建组件的几种方式现成轮子直接用 官方仓库搜索 https://pub.dev/flutter/packages https://pub.flutter-">
<meta name="twitter:image" content="https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/2020-08-06-16-27-33.png">
    
        <link rel="alternate" type="application/atom+xml" title="duCafeCat" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">猫哥</h5>
          <a href="mailto:ducafecat@gmail.com" title="ducafecat@gmail.com" class="mail">ducafecat@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
            <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Flutter 混合开发 - 02 百度地图定位功能 android 篇</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off"
                placeholder="Search" />
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
         
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <div class="container fade-scale">
        <h1 class="title">Flutter 混合开发 - 02 百度地图定位功能 android 篇</h1>
        <h5 class="subtitle">
             <time datetime="2020-08-03T16:00:00.000Z" itemprop="datePublished" class="page-time">
	2020-08-04
</time>


<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Flutter混合开发/">Flutter混合开发</a></li></ul>
 
        </h5>
    </div>

    

</header>

<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#本节目标"><span class="post-toc-number">1.</span> <span class="post-toc-text">本节目标</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#视频"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">视频</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#代码"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">代码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#正文"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">正文</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建组件的几种方式"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">创建组件的几种方式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#现成轮子直接用"><span class="post-toc-number">1.3.1.1.</span> <span class="post-toc-text">现成轮子直接用</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#可参考的组件代码"><span class="post-toc-number">1.3.1.2.</span> <span class="post-toc-text">可参考的组件代码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#参考官方集成文档编写组件"><span class="post-toc-number">1.3.1.3.</span> <span class="post-toc-text">参考官方集成文档编写组件</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#百度地图定位功能"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">百度地图定位功能</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#百度应用管理，创建-AK"><span class="post-toc-number">1.3.2.1.</span> <span class="post-toc-text">百度应用管理，创建 AK</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#设置-Android-权限"><span class="post-toc-number">1.3.2.2.</span> <span class="post-toc-text">设置 Android 权限</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#添加-android-libs-库文件"><span class="post-toc-number">1.3.2.3.</span> <span class="post-toc-text">添加 android libs 库文件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#编写-Flutter-组件代码"><span class="post-toc-number">1.3.2.4.</span> <span class="post-toc-text">编写 Flutter 组件代码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#触发-registerWith-的方式，老项目"><span class="post-toc-number">1.3.2.5.</span> <span class="post-toc-text">触发 registerWith 的方式，老项目</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#成员变量、同步、异步处理"><span class="post-toc-number">1.3.2.6.</span> <span class="post-toc-text">成员变量、同步、异步处理</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#组件生命周期"><span class="post-toc-number">1.3.2.7.</span> <span class="post-toc-text">组件生命周期</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#地图业务参数"><span class="post-toc-number">1.3.2.8.</span> <span class="post-toc-text">地图业务参数</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#编写启动、停止功能"><span class="post-toc-number">1.3.2.9.</span> <span class="post-toc-text">编写启动、停止功能</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#百度定位回调"><span class="post-toc-number">1.3.2.10.</span> <span class="post-toc-text">百度定位回调</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#位置提醒服务"><span class="post-toc-number">1.3.2.11.</span> <span class="post-toc-text">位置提醒服务</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Flutter-Example-动态授权"><span class="post-toc-number">1.3.2.12.</span> <span class="post-toc-text">Flutter Example 动态授权</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Flutter-Example-调用组件-API"><span class="post-toc-number">1.3.2.13.</span> <span class="post-toc-text">Flutter Example 调用组件 API</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#参考"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">参考</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-flutter-daily/flutter-plugins-02-baidu-map-android" class="post-article article-type-post fade"
    itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Flutter 混合开发 - 02 百度地图定位功能 android 篇</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-08-04 00:00:00" datetime="2020-08-03T16:00:00.000Z"  itemprop="datePublished">2020-08-04</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Flutter混合开发/">Flutter混合开发</a></li></ul>



            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="本节目标"><a href="#本节目标" class="headerlink" title="本节目标"></a>本节目标</h1><ul>
<li>百度地图业务</li>
<li>百度组件初始</li>
<li>编写定位代码 android 篇</li>
</ul>
<h2 id="视频"><a href="#视频" class="headerlink" title="视频"></a>视频</h2><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://github.com/ducafecat/flutter_baidu_plugin_ducafecat/releases/tag/v1.0.2" target="_blank" rel="noopener">https://github.com/ducafecat/flutter_baidu_plugin_ducafecat/releases/tag/v1.0.2</a></p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><h3 id="创建组件的几种方式"><a href="#创建组件的几种方式" class="headerlink" title="创建组件的几种方式"></a>创建组件的几种方式</h3><h4 id="现成轮子直接用"><a href="#现成轮子直接用" class="headerlink" title="现成轮子直接用"></a>现成轮子直接用</h4><ul>
<li><p>官方仓库搜索</p>
<p><a href="https://pub.dev/flutter/packages" target="_blank" rel="noopener">https://pub.dev/flutter/packages</a></p>
<p><a href="https://pub.flutter-io.cn/flutter/packages" target="_blank" rel="noopener">https://pub.flutter-io.cn/flutter/packages</a></p>
</li>
</ul>
<h4 id="可参考的组件代码"><a href="#可参考的组件代码" class="headerlink" title="可参考的组件代码"></a>可参考的组件代码</h4><ul>
<li><p>通过仓库，查找 github 代码仓</p>
</li>
<li><p>网站、客服索取代码</p>
</li>
</ul>
<h4 id="参考官方集成文档编写组件"><a href="#参考官方集成文档编写组件" class="headerlink" title="参考官方集成文档编写组件"></a>参考官方集成文档编写组件</h4><ul>
<li>官网文档</li>
</ul>
<p><a href="http://lbsyun.baidu.com/index.php?title=flutter/loc" target="_blank" rel="noopener">http://lbsyun.baidu.com/index.php?title=flutter/loc</a></p>
<h3 id="百度地图定位功能"><a href="#百度地图定位功能" class="headerlink" title="百度地图定位功能"></a>百度地图定位功能</h3><h4 id="百度应用管理，创建-AK"><a href="#百度应用管理，创建-AK" class="headerlink" title="百度应用管理，创建 AK"></a>百度应用管理，创建 AK</h4><ul>
<li>应用管理</li>
</ul>
<p><a href="https://lbsyun.baidu.com/apiconsole/key#/home" target="_blank" rel="noopener">https://lbsyun.baidu.com/apiconsole/key#/home</a></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="2020-08-06-16-27-33.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>
<ul>
<li>查询 SHA1</li>
</ul>
<p><a href="http://lbsyun.baidu.com/index.php?title=FAQ/SHA1" target="_blank" rel="noopener">http://lbsyun.baidu.com/index.php?title=FAQ/SHA1</a></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="2020-08-06-16-29-26.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -v -keystore ~/.android/debug.keystore -<span class="built_in">alias</span> androiddebugkey</span><br></pre></td></tr></table></figure>
<ul>
<li>设置 AK</li>
</ul>
<p>example/android/app/src/main/AndroidManifest.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 在这里设置android端ak--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">"com.baidu.lbsapi.API_KEY"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:value</span>=<span class="string">"aCUtcLDufllGi4nEaKgU8FmBqufFyekh"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="设置-Android-权限"><a href="#设置-Android-权限" class="headerlink" title="设置 Android 权限"></a>设置 Android 权限</h4><ul>
<li>文档</li>
</ul>
<p><a href="http://lbsyun.baidu.com/index.php?title=android-locsdk/guide/create-project/android-studio" target="_blank" rel="noopener">http://lbsyun.baidu.com/index.php?title=android-locsdk/guide/create-project/android-studio</a></p>
<ul>
<li>android/src/main/AndroidManifest.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">package</span>=<span class="string">"tech.ducafecat.flutter_baidu_plugin_ducafecat"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 这个权限用于进行网络定位--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_COARSE_LOCATION"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 这个权限用于访问GPS定位--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_FINE_LOCATION"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 用于访问wifi网络信息，wifi信息会用于进行网络定位--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_WIFI_STATE"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 获取运营商信息，用于支持提供运营商信息相关的接口--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_NETWORK_STATE"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 这个权限用于获取wifi的获取权限，wifi信息会用来进行网络定位--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.CHANGE_WIFI_STATE"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 用于读取手机当前的状态--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.READ_PHONE_STATE"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 写入扩展存储，向扩展卡写入数据，用于写入离线定位数据--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.WRITE_EXTERNAL_STORAGE"</span>&gt;</span><span class="tag">&lt;/<span class="name">uses-permission</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 访问网络，网络定位需要上网--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.INTERNET"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 读取系统信息，包含系统版本等信息，用作统计--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"com.android.launcher.permission.READ_SETTINGS"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 程序在手机屏幕关闭后后台进程仍然运行--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.WAKE_LOCK"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 声明service组件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">service</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">"com.baidu.location.f"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:enabled</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:process</span>=<span class="string">":remote"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">service</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="添加-android-libs-库文件"><a href="#添加-android-libs-库文件" class="headerlink" title="添加 android libs 库文件"></a>添加 android libs 库文件</h4><ul>
<li>目录 android/libs</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="2020-08-06-16-27-07.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>
<h4 id="编写-Flutter-组件代码"><a href="#编写-Flutter-组件代码" class="headerlink" title="编写 Flutter 组件代码"></a>编写 Flutter 组件代码</h4><ul>
<li>目录 lib</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="2020-08-06-16-30-34.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>
<ul>
<li>地理信息 lib/entity/flutter_baidu_location.dart</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="markdown">百度定位结果类，用于存储各类定位结果信息</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaiduLocation</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> locTime;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">定位成功时间</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> locType;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">定位结果类型</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">double</span> radius;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">精度</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">double</span> latitude;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">纬度</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">double</span> longitude;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">经度</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">double</span> altitude;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">高度</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> country;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">国家</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> province;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">省份</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> city;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">城市</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> district;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">区县</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> street;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">街道</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> address;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">地址</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> locationDetail;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">位置语义化描述，例如"在百度大厦附近"</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> poiList;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">周边poi信息，每个poi之间用"|"隔开</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> callbackTime;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">定位结果回调时间</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> errorCode;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">错误码</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> errorInfo;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">定位失败描述信息</span></span></span><br><span class="line"></span><br><span class="line">  BaiduLocation(</span><br><span class="line">      &#123;<span class="keyword">this</span>.locTime,</span><br><span class="line">      <span class="keyword">this</span>.locType,</span><br><span class="line">      <span class="keyword">this</span>.radius,</span><br><span class="line">      <span class="keyword">this</span>.latitude,</span><br><span class="line">      <span class="keyword">this</span>.longitude,</span><br><span class="line">      <span class="keyword">this</span>.altitude,</span><br><span class="line">      <span class="keyword">this</span>.country,</span><br><span class="line">      <span class="keyword">this</span>.province,</span><br><span class="line">      <span class="keyword">this</span>.city,</span><br><span class="line">      <span class="keyword">this</span>.district,</span><br><span class="line">      <span class="keyword">this</span>.street,</span><br><span class="line">      <span class="keyword">this</span>.address,</span><br><span class="line">      <span class="keyword">this</span>.locationDetail,</span><br><span class="line">      <span class="keyword">this</span>.poiList,</span><br><span class="line">      <span class="keyword">this</span>.callbackTime,</span><br><span class="line">      <span class="keyword">this</span>.errorCode,</span><br><span class="line">      <span class="keyword">this</span>.errorInfo&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">根据传入的map生成BaiduLocation对象</span></span></span><br><span class="line">  <span class="keyword">factory</span> BaiduLocation.fromMap(<span class="built_in">dynamic</span> value) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> BaiduLocation(</span><br><span class="line">      locTime: value[<span class="string">'locTime'</span>],</span><br><span class="line">      locType: value[<span class="string">'locType'</span>],</span><br><span class="line">      radius: value[<span class="string">'radius'</span>],</span><br><span class="line">      latitude: value[<span class="string">'latitude'</span>],</span><br><span class="line">      longitude: value[<span class="string">'longitude'</span>],</span><br><span class="line">      altitude: value[<span class="string">'altitude'</span>],</span><br><span class="line">      country: value[<span class="string">'country'</span>],</span><br><span class="line">      province: value[<span class="string">'province'</span>],</span><br><span class="line">      city: value[<span class="string">'city'</span>],</span><br><span class="line">      district: value[<span class="string">'district'</span>],</span><br><span class="line">      street: value[<span class="string">'street'</span>],</span><br><span class="line">      address: value[<span class="string">'address'</span>],</span><br><span class="line">      locationDetail: value[<span class="string">'locationDetail'</span>],</span><br><span class="line">      poiList: value[<span class="string">'poiList'</span>],</span><br><span class="line">      callbackTime: value[<span class="string">'callbackTime'</span>],</span><br><span class="line">      errorCode: value[<span class="string">'errorCode'</span>],</span><br><span class="line">      errorInfo: value[<span class="string">'errorInfo'</span>],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">获取对本类所有变量赋值后的map键值对</span></span></span><br><span class="line">  <span class="built_in">Map</span> getMap() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="string">"locTime"</span>: locTime,</span><br><span class="line">      <span class="string">"locType"</span>: locType,</span><br><span class="line">      <span class="string">"radius"</span>: radius,</span><br><span class="line">      <span class="string">"latitude"</span>: latitude,</span><br><span class="line">      <span class="string">"longitude"</span>: longitude,</span><br><span class="line">      <span class="string">"altitude"</span>: altitude,</span><br><span class="line">      <span class="string">"country"</span>: country,</span><br><span class="line">      <span class="string">"province"</span>: province,</span><br><span class="line">      <span class="string">"city"</span>: city,</span><br><span class="line">      <span class="string">"district"</span>: district,</span><br><span class="line">      <span class="string">"street"</span>: street,</span><br><span class="line">      <span class="string">"address"</span>: address,</span><br><span class="line">      <span class="string">"locationDescribe"</span>: locationDetail,</span><br><span class="line">      <span class="string">"poiList"</span>: poiList,</span><br><span class="line">      <span class="string">"callbackTime"</span>: callbackTime,</span><br><span class="line">      <span class="string">"errorCode"</span>: errorCode,</span><br><span class="line">      <span class="string">"errorInfo"</span>: errorInfo,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>android 配置项 lib/entity/flutter_baidu_location_android_option.dart</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="markdown">设置android端定位参数类</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaiduLocationAndroidOption</span> </span>&#123;</span><br><span class="line">  <span class="comment">/// <span class="markdown">坐标系类型</span></span></span><br><span class="line">  <span class="built_in">String</span> coorType;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要返回地址信息</span></span></span><br><span class="line">  <span class="built_in">bool</span> isNeedAddres;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要返回海拔高度信息</span></span></span><br><span class="line">  <span class="built_in">bool</span> isNeedAltitude;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要返回周边poi信息</span></span></span><br><span class="line">  <span class="built_in">bool</span> isNeedLocationPoiList;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要返回新版本rgc信息</span></span></span><br><span class="line">  <span class="built_in">bool</span> isNeedNewVersionRgc;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要返回位置描述信息</span></span></span><br><span class="line">  <span class="built_in">bool</span> isNeedLocationDescribe;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否使用gps</span></span></span><br><span class="line">  <span class="built_in">bool</span> openGps;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">可选，设置发起定位请求的间隔，int类型，单位ms</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">如果设置为0，则代表单次定位，即仅定位一次，默认为0</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">如果设置非0，需设置1000ms以上才有效</span></span></span><br><span class="line">  <span class="built_in">int</span> scanspan;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置定位模式，可选的模式有高精度、仅设备、仅网络。默认为高精度模式</span></span></span><br><span class="line">  <span class="built_in">int</span> locationMode;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">可选，设置场景定位参数，包括签到场景、运动场景、出行场景</span></span></span><br><span class="line">  <span class="built_in">int</span> locationPurpose;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">可选，设置返回经纬度坐标类型，默认GCJ02</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">GCJ02：国测局坐标；</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">BD09ll：百度经纬度坐标；</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">BD09：百度墨卡托坐标；</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">海外地区定位，无需设置坐标类型，统一返回WGS84类型坐标</span></span></span><br><span class="line">  <span class="keyword">void</span> setCoorType(<span class="built_in">String</span> coorType) &#123;</span><br><span class="line">    <span class="keyword">this</span>.coorType = coorType;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要返回地址信息</span></span></span><br><span class="line">  <span class="keyword">void</span> setIsNeedAddres(<span class="built_in">bool</span> isNeedAddres) &#123;</span><br><span class="line">    <span class="keyword">this</span>.isNeedAddres = isNeedAddres;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要返回海拔高度信息</span></span></span><br><span class="line">  <span class="keyword">void</span> setIsNeedAltitude(<span class="built_in">bool</span> isNeedAltitude) &#123;</span><br><span class="line">    <span class="keyword">this</span>.isNeedAltitude = isNeedAltitude;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要返回周边poi信息</span></span></span><br><span class="line">  <span class="keyword">void</span> setIsNeedLocationPoiList(<span class="built_in">bool</span> isNeedLocationPoiList) &#123;</span><br><span class="line">    <span class="keyword">this</span>.isNeedLocationPoiList = isNeedLocationPoiList;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要返回位置描述信息</span></span></span><br><span class="line">  <span class="keyword">void</span> setIsNeedLocationDescribe(<span class="built_in">bool</span> isNeedLocationDescribe) &#123;</span><br><span class="line">    <span class="keyword">this</span>.isNeedLocationDescribe = isNeedLocationDescribe;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要返回新版本rgc信息</span></span></span><br><span class="line">  <span class="keyword">void</span> setIsNeedNewVersionRgc(<span class="built_in">bool</span> isNeedNewVersionRgc) &#123;</span><br><span class="line">    <span class="keyword">this</span>.isNeedNewVersionRgc = isNeedNewVersionRgc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否使用gps</span></span></span><br><span class="line">  <span class="keyword">void</span> setOpenGps(<span class="built_in">bool</span> openGps) &#123;</span><br><span class="line">    <span class="keyword">this</span>.openGps = openGps;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">可选，设置发起定位请求的间隔，int类型，单位ms</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">如果设置为0，则代表单次定位，即仅定位一次，默认为0</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">如果设置非0，需设置1000ms以上才有效</span></span></span><br><span class="line">  <span class="keyword">void</span> setScanspan(<span class="built_in">int</span> scanspan) &#123;</span><br><span class="line">    <span class="keyword">this</span>.scanspan = scanspan;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置定位模式，可选的模式有高精度、仅设备、仅网络，默认为高精度模式</span></span></span><br><span class="line">  <span class="keyword">void</span> setLocationMode(LocationMode locationMode) &#123;</span><br><span class="line">    <span class="keyword">if</span> (locationMode == LocationMode.Hight_Accuracy) &#123;</span><br><span class="line">      <span class="keyword">this</span>.locationMode = <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (locationMode == LocationMode.Device_Sensors) &#123;</span><br><span class="line">      <span class="keyword">this</span>.locationMode = <span class="number">2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (locationMode == LocationMode.Battery_Saving) &#123;</span><br><span class="line">      <span class="keyword">this</span>.locationMode = <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">可选，设置场景定位参数，包括签到场景、运动场景、出行场景</span></span></span><br><span class="line">  <span class="keyword">void</span> setLocationPurpose(BDLocationPurpose locationPurpose) &#123;</span><br><span class="line">    <span class="keyword">if</span> (locationPurpose == BDLocationPurpose.SignIn) &#123;</span><br><span class="line">      <span class="keyword">this</span>.locationPurpose = <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (locationPurpose == BDLocationPurpose.Transport) &#123;</span><br><span class="line">      <span class="keyword">this</span>.locationPurpose = <span class="number">2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (locationPurpose == BDLocationPurpose.Sport) &#123;</span><br><span class="line">      <span class="keyword">this</span>.locationPurpose = <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  BaiduLocationAndroidOption(</span><br><span class="line">      &#123;<span class="keyword">this</span>.coorType,</span><br><span class="line">      <span class="keyword">this</span>.isNeedAddres,</span><br><span class="line">      <span class="keyword">this</span>.isNeedAltitude,</span><br><span class="line">      <span class="keyword">this</span>.isNeedLocationPoiList,</span><br><span class="line">      <span class="keyword">this</span>.isNeedNewVersionRgc,</span><br><span class="line">      <span class="keyword">this</span>.openGps,</span><br><span class="line">      <span class="keyword">this</span>.isNeedLocationDescribe,</span><br><span class="line">      <span class="keyword">this</span>.scanspan,</span><br><span class="line">      <span class="keyword">this</span>.locationMode,</span><br><span class="line">      <span class="keyword">this</span>.locationPurpose&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">根据传入的map生成BaiduLocationAndroidOption对象</span></span></span><br><span class="line">  <span class="keyword">factory</span> BaiduLocationAndroidOption.fromMap(<span class="built_in">dynamic</span> value) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> BaiduLocationAndroidOption(</span><br><span class="line">      coorType: value[<span class="string">'coorType'</span>],</span><br><span class="line">      isNeedAddres: value[<span class="string">'isNeedAddres'</span>],</span><br><span class="line">      isNeedAltitude: value[<span class="string">'isNeedAltitude'</span>],</span><br><span class="line">      isNeedLocationPoiList: value[<span class="string">'isNeedLocationPoiList'</span>],</span><br><span class="line">      isNeedNewVersionRgc: value[<span class="string">'isNeedNewVersionRgc'</span>],</span><br><span class="line">      openGps: value[<span class="string">'openGps'</span>],</span><br><span class="line">      isNeedLocationDescribe: value[<span class="string">''</span>],</span><br><span class="line">      scanspan: value[<span class="string">'scanspan'</span>],</span><br><span class="line">      locationMode: value[<span class="string">'locationMode'</span>],</span><br><span class="line">      locationPurpose: value[<span class="string">'LocationPurpose'</span>],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">获取对本类所有变量赋值后的map键值对</span></span></span><br><span class="line">  <span class="built_in">Map</span> getMap() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="string">"coorType"</span>: coorType,</span><br><span class="line">      <span class="string">"isNeedAddres"</span>: isNeedAddres,</span><br><span class="line">      <span class="string">"isNeedAltitude"</span>: isNeedAltitude,</span><br><span class="line">      <span class="string">"isNeedLocationPoiList"</span>: isNeedLocationPoiList,</span><br><span class="line">      <span class="string">"isNeedNewVersionRgc"</span>: isNeedNewVersionRgc,</span><br><span class="line">      <span class="string">"openGps"</span>: openGps,</span><br><span class="line">      <span class="string">"isNeedLocationDescribe"</span>: isNeedLocationDescribe,</span><br><span class="line">      <span class="string">"scanspan"</span>: scanspan,</span><br><span class="line">      <span class="string">"locationMode"</span>: locationMode,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// <span class="markdown">定位模式枚举类</span></span></span><br><span class="line"><span class="keyword">enum</span> LocationMode &#123;</span><br><span class="line">  <span class="comment">/// <span class="markdown">高精度模式</span></span></span><br><span class="line">  Hight_Accuracy,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">低功耗模式</span></span></span><br><span class="line">  Battery_Saving,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">仅设备(Gps)模式</span></span></span><br><span class="line">  Device_Sensors</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// <span class="markdown">场景定位枚举类</span></span></span><br><span class="line"><span class="keyword">enum</span> BDLocationPurpose &#123;</span><br><span class="line">  <span class="comment">///  <span class="markdown">签到场景</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">只进行一次定位返回最接近真实位置的定位结果（定位速度可能会延迟1-3s）</span></span></span><br><span class="line">  SignIn,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">出行场景</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">高精度连续定位，适用于有户内外切换的场景，卫星定位和网络定位相互切换，卫星定位成功之后网络定位不再返回，卫星信号断开之后一段时间才会返回网络结果</span></span></span><br><span class="line">  Sport,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">运动场景</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">高精度连续定位，适用于有户内外切换的场景，卫星定位和网络定位相互切换，卫星定位成功之后网络定位不再返回，卫星信号断开之后一段时间才会返回网络结果</span></span></span><br><span class="line">  Transport</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ios 配置项 lib/entity/flutter_baidu_location_ios_option.dart</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="markdown">设置ios端定位参数类</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaiduLocationIOSOption</span> </span>&#123;</span><br><span class="line">  <span class="comment">/// <span class="markdown">设置位置获取超时时间</span></span></span><br><span class="line">  <span class="built_in">int</span> locationTimeout;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置获取地址信息超时时间</span></span></span><br><span class="line">  <span class="built_in">int</span> reGeocodeTimeout;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置应用位置类型</span></span></span><br><span class="line">  <span class="built_in">String</span> activityType;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置返回位置的坐标系类型</span></span></span><br><span class="line">  <span class="built_in">String</span> BMKLocationCoordinateType;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置预期精度参数</span></span></span><br><span class="line">  <span class="built_in">String</span> desiredAccuracy;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要最新版本rgc数据</span></span></span><br><span class="line">  <span class="built_in">bool</span> isNeedNewVersionRgc;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">指定定位是否会被系统自动暂停</span></span></span><br><span class="line">  <span class="built_in">bool</span> pausesLocationUpdatesAutomatically;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">指定是否允许后台定位</span></span></span><br><span class="line">  <span class="built_in">bool</span> allowsBackgroundLocationUpdates;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设定定位的最小更新距离</span></span></span><br><span class="line">  <span class="built_in">double</span> distanceFilter;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">指定是否允许后台定位</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">allowsBackgroundLocationUpdates为true则允许后台定位</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">allowsBackgroundLocationUpdates为false则不允许后台定位</span></span></span><br><span class="line">  <span class="keyword">void</span> setAllowsBackgroundLocationUpdates(</span><br><span class="line">      <span class="built_in">bool</span> allowsBackgroundLocationUpdates) &#123;</span><br><span class="line">    <span class="keyword">this</span>.allowsBackgroundLocationUpdates = allowsBackgroundLocationUpdates;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">指定定位是否会被系统自动暂停</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">pausesLocationUpdatesAutomatically为true则定位会被系统自动暂停</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">pausesLocationUpdatesAutomatically为false则定位不会被系统自动暂停</span></span></span><br><span class="line">  <span class="keyword">void</span> setPauseLocUpdateAutomatically(<span class="built_in">bool</span> pausesLocationUpdatesAutomatically) &#123;</span><br><span class="line">    <span class="keyword">this</span>.pausesLocationUpdatesAutomatically =</span><br><span class="line">        pausesLocationUpdatesAutomatically;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置位置获取超时时间</span></span></span><br><span class="line">  <span class="keyword">void</span> setLocationTimeout(<span class="built_in">int</span> locationTimeout) &#123;</span><br><span class="line">    <span class="keyword">this</span>.locationTimeout = locationTimeout;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置获取地址信息超时时间</span></span></span><br><span class="line">  <span class="keyword">void</span> setReGeocodeTimeout(<span class="built_in">int</span> reGeocodeTimeout) &#123;</span><br><span class="line">    <span class="keyword">this</span>.reGeocodeTimeout = reGeocodeTimeout;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置应用位置类型</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">activityType可选值包括:</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"CLActivityTypeOther"</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"CLActivityTypeAutomotiveNavigation"</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"CLActivityTypeFitness"</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"CLActivityTypeOtherNavigation"</span></span></span><br><span class="line">  <span class="keyword">void</span> setActivityType(<span class="built_in">String</span> activityType) &#123;</span><br><span class="line">    <span class="keyword">this</span>.activityType = activityType;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置返回位置的坐标系类型</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">BMKLocationCoordinateType可选值包括:</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"BMKLocationCoordinateTypeBMK09LL"</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"BMKLocationCoordinateTypeBMK09MC"</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"BMKLocationCoordinateTypeWGS84"</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"BMKLocationCoordinateTypeGCJ02"</span></span></span><br><span class="line">  <span class="keyword">void</span> setBMKLocationCoordinateType(<span class="built_in">String</span> BMKLocationCoordinateType) &#123;</span><br><span class="line">    <span class="keyword">this</span>.BMKLocationCoordinateType = BMKLocationCoordinateType;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置预期精度参数</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">desiredAccuracy可选值包括:</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"kCLLocationAccuracyBest"</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"kCLLocationAccuracyNearestTenMeters"</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"kCLLocationAccuracyHundredMeters"</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">"kCLLocationAccuracyKilometer"</span></span></span><br><span class="line">  <span class="keyword">void</span> setDesiredAccuracy(<span class="built_in">String</span> desiredAccuracy) &#123;</span><br><span class="line">    <span class="keyword">this</span>.desiredAccuracy = desiredAccuracy;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设定定位的最小更新距离</span></span></span><br><span class="line">  <span class="keyword">void</span> setDistanceFilter(<span class="built_in">double</span> distanceFilter) &#123;</span><br><span class="line">    <span class="keyword">this</span>.distanceFilter = distanceFilter;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">是否需要最新版本rgc数据</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">isNeedNewVersionRgc为true则需要返回最新版本rgc数据</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">isNeedNewVersionRgc为false则不需要返回最新版本rgc数据</span></span></span><br><span class="line">  <span class="keyword">void</span> setIsNeedNewVersionRgc(<span class="built_in">bool</span> isNeedNewVersionRgc) &#123;</span><br><span class="line">    <span class="keyword">this</span>.isNeedNewVersionRgc = isNeedNewVersionRgc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  BaiduLocationIOSOption(</span><br><span class="line">      &#123;<span class="keyword">this</span>.locationTimeout,</span><br><span class="line">      <span class="keyword">this</span>.reGeocodeTimeout,</span><br><span class="line">      <span class="keyword">this</span>.activityType,</span><br><span class="line">      <span class="keyword">this</span>.BMKLocationCoordinateType,</span><br><span class="line">      <span class="keyword">this</span>.desiredAccuracy,</span><br><span class="line">      <span class="keyword">this</span>.isNeedNewVersionRgc,</span><br><span class="line">      <span class="keyword">this</span>.pausesLocationUpdatesAutomatically,</span><br><span class="line">      <span class="keyword">this</span>.allowsBackgroundLocationUpdates,</span><br><span class="line">      <span class="keyword">this</span>.distanceFilter&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">根据传入的map生成BaiduLocationIOSOption对象</span></span></span><br><span class="line">  <span class="keyword">factory</span> BaiduLocationIOSOption.fromMap(<span class="built_in">dynamic</span> value) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> BaiduLocationIOSOption(</span><br><span class="line">      locationTimeout: value[<span class="string">'locationTimeout'</span>],</span><br><span class="line">      reGeocodeTimeout: value[<span class="string">'reGeocodeTimeout'</span>],</span><br><span class="line">      activityType: value[<span class="string">'activityType'</span>],</span><br><span class="line">      BMKLocationCoordinateType: value[<span class="string">'BMKLocationCoordinateType'</span>],</span><br><span class="line">      desiredAccuracy: value[<span class="string">'desiredAccuracy'</span>],</span><br><span class="line">      isNeedNewVersionRgc: value[<span class="string">'isNeedNewVersionRgc'</span>],</span><br><span class="line">      pausesLocationUpdatesAutomatically:</span><br><span class="line">          value[<span class="string">'pausesLocationUpdatesAutomatically'</span>],</span><br><span class="line">      allowsBackgroundLocationUpdates: value[<span class="string">'allowsBackgroundLocationUpdates'</span>],</span><br><span class="line">      distanceFilter: value[<span class="string">'distanceFilter'</span>],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">获取对本类所有变量赋值后的map键值对</span></span></span><br><span class="line">  <span class="built_in">Map</span> getMap() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="string">"locationTimeout"</span>: locationTimeout,</span><br><span class="line">      <span class="string">"reGeocodeTimeout"</span>: reGeocodeTimeout,</span><br><span class="line">      <span class="string">"activityType"</span>: activityType,</span><br><span class="line">      <span class="string">"BMKLocationCoordinateType"</span>: BMKLocationCoordinateType,</span><br><span class="line">      <span class="string">"desiredAccuracy"</span>: desiredAccuracy,</span><br><span class="line">      <span class="string">"isNeedNewVersionRgc"</span>: isNeedNewVersionRgc,</span><br><span class="line">      <span class="string">"pausesLocationUpdatesAutomatically"</span>: pausesLocationUpdatesAutomatically,</span><br><span class="line">      <span class="string">"allowsBackgroundLocationUpdates"</span>: allowsBackgroundLocationUpdates,</span><br><span class="line">      <span class="string">"distanceFilter"</span>: distanceFilter,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>接口 lib/flutter_baidu_plugin_ducafecat.dart</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'dart:async'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'dart:io'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/services.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FlutterBaiduPluginDucafecat</span> </span>&#123;</span><br><span class="line">  <span class="comment">/// <span class="markdown">flutter端主动调用原生端方法</span></span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">const</span> MethodChannel _channel =</span><br><span class="line">      <span class="keyword">const</span> MethodChannel(<span class="string">'flutter_baidu_plugin_ducafecat'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">原生端主动回传结果数据到flutter端</span></span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">const</span> EventChannel _stream =</span><br><span class="line">      <span class="keyword">const</span> EventChannel(<span class="string">"flutter_baidu_plugin_ducafecat_stream"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">ios 下设置 key</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">android 在 AndroidManifest.xml 中设置</span></span></span><br><span class="line">  <span class="keyword">static</span> Future&lt;<span class="built_in">bool</span>&gt; setApiKey(<span class="built_in">String</span> key) <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> _channel.invokeMethod(<span class="string">"setApiKey"</span>, key);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">设置定位参数</span></span></span><br><span class="line">  <span class="keyword">void</span> prepareLoc(<span class="built_in">Map</span> androidMap, <span class="built_in">Map</span> iosMap) &#123;</span><br><span class="line">    <span class="built_in">Map</span> map;</span><br><span class="line">    <span class="keyword">if</span> (Platform.isAndroid) &#123;</span><br><span class="line">      map = androidMap;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      map = iosMap;</span><br><span class="line">    &#125;</span><br><span class="line">    _channel.invokeMethod(<span class="string">"updateOption"</span>, map);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">启动定位</span></span></span><br><span class="line">  <span class="keyword">void</span> startLocation() &#123;</span><br><span class="line">    _channel.invokeMethod(<span class="string">'startLocation'</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">停止定位</span></span></span><br><span class="line">  <span class="keyword">void</span> stopLocation() &#123;</span><br><span class="line">    _channel.invokeMethod(<span class="string">'stopLocation'</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">原生端回传键值对map到flutter端</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">map中key为isInChina对应的value，如果为1则判断是在国内，为0则判断是在国外</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">map中存在key为nearby则判断为已到达设置监听位置附近</span></span></span><br><span class="line">  Stream&lt;<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">Object</span>&gt;&gt; onResultCallback() &#123;</span><br><span class="line">    Stream&lt;<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">Object</span>&gt;&gt; _resultMap;</span><br><span class="line">    <span class="keyword">if</span> (_resultMap == <span class="keyword">null</span>) &#123;</span><br><span class="line">      _resultMap = _stream.receiveBroadcastStream().map&lt;<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">Object</span>&gt;&gt;(</span><br><span class="line">          (element) =&gt; element.cast&lt;<span class="built_in">String</span>, <span class="built_in">Object</span>&gt;());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _resultMap;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="触发-registerWith-的方式，老项目"><a href="#触发-registerWith-的方式，老项目" class="headerlink" title="触发 registerWith 的方式，老项目"></a>触发 registerWith 的方式，老项目</h4><blockquote>
<p>// This static function is optional and equivalent to onAttachedToEngine. It supports the old<br>// pre-Flutter-1.12 Android projects. You are encouraged to continue supporting<br>// plugin registration via this function while apps migrate to use the new Android APIs<br>// post-flutter-1.12 via <a href="https://flutter.dev/go/android-project-migration" target="_blank" rel="noopener">https://flutter.dev/go/android-project-migration</a>.</p>
</blockquote>
<ul>
<li>android 组件代码</li>
</ul>
<p>android/src/main/java/tech/ducafecat/flutter_baidu_plugin_ducafecat/FlutterBaiduPluginDucafecatPlugin.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">registerWith</span><span class="params">(Registrar registrar)</span> </span>&#123;</span><br><span class="line">  ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>example android 注册组件</li>
</ul>
<p>example/android/app/src/main/java/io/flutter/plugins/GeneratedPluginRegistrant.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneratedPluginRegistrant</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">registerWith</span><span class="params">(PluginRegistry registry)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (alreadyRegisteredWith(registry)) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    LocationFlutterPlugin.registerWith(registry.registrarFor(<span class="string">"com.baidu.bdmap_location_flutter_plugin.LocationFlutterPlugin"</span>));</span><br><span class="line">    PermissionHandlerPlugin.registerWith(registry.registrarFor(<span class="string">"com.baseflow.permissionhandler.PermissionHandlerPlugin"</span>));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">alreadyRegisteredWith</span><span class="params">(PluginRegistry registry)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> String key = GeneratedPluginRegistrant<span class="class">.<span class="keyword">class</span>.<span class="title">getCanonicalName</span>()</span>;</span><br><span class="line">    <span class="keyword">if</span> (registry.hasPlugin(key)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    registry.registrarFor(key);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="成员变量、同步、异步处理"><a href="#成员变量、同步、异步处理" class="headerlink" title="成员变量、同步、异步处理"></a>成员变量、同步、异步处理</h4><p>MethodChannel 请求方法后，同步返回结果</p>
<p>EventChannel 组件主动推消息到 Flutter</p>
<ul>
<li>android/src/main/java/tech/ducafecat/flutter_baidu_plugin_ducafecat/FlutterBaiduPluginDucafecatPlugin.java</li>
</ul>
<p>用到的成员变量先定义下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlutterBaiduPluginDucafecatPlugin</span> <span class="keyword">implements</span> <span class="title">FlutterPlugin</span>, <span class="title">MethodCallHandler</span>, <span class="title">EventChannel</span>.<span class="title">StreamHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通道名称</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CHANNEL_METHOD_LOCATION = <span class="string">"flutter_baidu_plugin_ducafecat"</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CHANNEL_STREAM_LOCATION = <span class="string">"flutter_baidu_plugin_ducafecat_stream"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> Context mContext = <span class="keyword">null</span>; <span class="comment">// flutter view context</span></span><br><span class="line">  <span class="keyword">private</span> LocationClient mLocationClient = <span class="keyword">null</span>; <span class="comment">// 定位对象</span></span><br><span class="line">  <span class="keyword">private</span> EventChannel.EventSink mEventSink = <span class="keyword">null</span>; <span class="comment">// 事件对象</span></span><br><span class="line">  <span class="keyword">private</span> BDNotifyListener mNotifyListener; <span class="comment">// 位置提醒对象</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">boolean</span> isPurporseLoc = <span class="keyword">false</span>; <span class="comment">// 签到场景</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">boolean</span> isInChina = <span class="keyword">false</span>;  <span class="comment">// 是否启用国内外位置判断功能</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">boolean</span> isNotify = <span class="keyword">false</span>; <span class="comment">// 位置提醒</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通道对象</span></span><br><span class="line">  <span class="keyword">private</span> MethodChannel channel = <span class="keyword">null</span>;</span><br><span class="line">  <span class="keyword">private</span> EventChannel eventChannel = <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<h4 id="组件生命周期"><a href="#组件生命周期" class="headerlink" title="组件生命周期"></a>组件生命周期</h4><ul>
<li>文件</li>
</ul>
<p>android/src/main/java/tech/ducafecat/flutter_baidu_plugin_ducafecat/FlutterBaiduPluginDucafecatPlugin.java</p>
<ul>
<li>组件注册 onAttachedToEngine</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAttachedToEngine</span><span class="params">(@NonNull FlutterPluginBinding flutterPluginBinding)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.mContext = flutterPluginBinding.getApplicationContext();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 开始、停止定位</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  channel = <span class="keyword">new</span> MethodChannel(flutterPluginBinding.getBinaryMessenger(), CHANNEL_METHOD_LOCATION);</span><br><span class="line">  channel.setMethodCallHandler(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 监听位置变化</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  eventChannel = <span class="keyword">new</span> EventChannel(flutterPluginBinding.getBinaryMessenger(), CHANNEL_STREAM_LOCATION);</span><br><span class="line">  eventChannel.setStreamHandler(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>老项目 组件注册 registerWith</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">registerWith</span><span class="params">(Registrar registrar)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    FlutterBaiduPluginDucafecatPlugin plugin = <span class="keyword">new</span> FlutterBaiduPluginDucafecatPlugin();</span><br><span class="line">    plugin.mContext = registrar.context();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 开始、停止定位</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">final</span> MethodChannel channel = <span class="keyword">new</span> MethodChannel(registrar.messenger(), CHANNEL_METHOD_LOCATION);</span><br><span class="line">    channel.setMethodCallHandler(plugin);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 监听位置变化</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">final</span> EventChannel eventChannel = <span class="keyword">new</span> EventChannel(registrar.messenger(), CHANNEL_STREAM_LOCATION);</span><br><span class="line">    eventChannel.setStreamHandler(plugin);</span><br><span class="line"></span><br><span class="line"><span class="comment">//    final MethodChannel channel = new MethodChannel(registrar.messenger(), "flutter_baidu_plugin_ducafecat");</span></span><br><span class="line"><span class="comment">//    channel.setMethodCallHandler(new FlutterBaiduPluginDucafecatPlugin());</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>注销组件 onCancel</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCancel</span><span class="params">(Object arguments)</span> </span>&#123;</span><br><span class="line">  stopLocation();</span><br><span class="line">  <span class="keyword">if</span> (isNotify) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> != mLocationClient) &#123;</span><br><span class="line">      mLocationClient.removeNotifyEvent(mNotifyListener);</span><br><span class="line">    &#125;</span><br><span class="line">    mNotifyListener = <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>销毁组件 onDetachedFromEngine</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDetachedFromEngine</span><span class="params">(@NonNull FlutterPluginBinding binding)</span> </span>&#123;</span><br><span class="line">  channel.setMethodCallHandler(<span class="keyword">null</span>);</span><br><span class="line">  eventChannel.setStreamHandler(<span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法调用 onMethodCall</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMethodCall</span><span class="params">(@NonNull MethodCall call, @NonNull Result result)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">"startLocation"</span>.equals(call.method)) &#123;</span><br><span class="line">    startLocation(); <span class="comment">// 启动定位</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"stopLocation"</span>.equals(call.method)) &#123;</span><br><span class="line">    stopLocation(); <span class="comment">// 停止定位</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"updateOption"</span>.equals(call.method)) &#123; <span class="comment">// 设置定位参数</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      updateOption((Map) call.arguments);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="string">"getPlatformVersion"</span>).equals(call.method)) &#123;</span><br><span class="line">    result.success(<span class="string">"Android "</span> + android.os.Build.VERSION.RELEASE);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    result.notImplemented();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>flutter onListen 回调对象</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onListen</span><span class="params">(Object arguments, EventChannel.EventSink events)</span> </span>&#123;</span><br><span class="line">  mEventSink = events;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="地图业务参数"><a href="#地图业务参数" class="headerlink" title="地图业务参数"></a>地图业务参数</h4><ul>
<li>更新参数 updateOption</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 准备定位</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> arguments</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">updateOption</span><span class="params">(Map arguments)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">null</span> == mLocationClient) &#123;</span><br><span class="line">    mLocationClient = <span class="keyword">new</span> LocationClient(mContext);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 判断是否启用位置提醒功能</span></span><br><span class="line">  <span class="keyword">if</span> (arguments.containsKey(<span class="string">"isNotify"</span>)) &#123;</span><br><span class="line">    isNotify = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> == mNotifyListener) &#123;</span><br><span class="line">      mNotifyListener = <span class="keyword">new</span> MyNotifyLister();</span><br><span class="line">    &#125;</span><br><span class="line">    mLocationClient.registerNotify(mNotifyListener);</span><br><span class="line">    <span class="keyword">double</span> lat = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">double</span> lon = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">float</span> radius = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"latitude"</span>)) &#123;</span><br><span class="line">      lat = (<span class="keyword">double</span>)arguments.get(<span class="string">"latitude"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"longitude"</span>)) &#123;</span><br><span class="line">      lon = (<span class="keyword">double</span>)arguments.get(<span class="string">"longitude"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"radius"</span>)) &#123;</span><br><span class="line">      <span class="keyword">double</span> radius1 = (<span class="keyword">double</span>)arguments.get(<span class="string">"radius"</span>);</span><br><span class="line">      radius = Float.parseFloat(String.valueOf(radius1));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String coorType = mLocationClient.getLocOption().getCoorType();</span><br><span class="line">    mNotifyListener.SetNotifyLocation(lat, lon, radius, coorType);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    isNotify = <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  mLocationClient.registerLocationListener(<span class="keyword">new</span> CurrentLocationListener());</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断是否启用国内外位置判断功能</span></span><br><span class="line">  <span class="keyword">if</span> (arguments.containsKey(<span class="string">"isInChina"</span>)) &#123;</span><br><span class="line">    isInChina = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    isInChina =<span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  LocationClientOption option = <span class="keyword">new</span> LocationClientOption();</span><br><span class="line">  parseOptions(option, arguments);</span><br><span class="line">  option.setProdName(<span class="string">"flutter"</span>);</span><br><span class="line">  mLocationClient.setLocOption(option);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>解析定位参数 parseOptions</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 解析定位参数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> option</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> arguments</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseOptions</span><span class="params">(LocationClientOption option,Map arguments)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (arguments != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可选，设置是否返回逆地理地址信息。默认是true</span></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"isNeedAddres"</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (((<span class="keyword">boolean</span>)arguments.get(<span class="string">"isNeedAddres"</span>))) &#123;</span><br><span class="line">        option.setIsNeedAddress(<span class="keyword">true</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        option.setIsNeedAddress(<span class="keyword">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可选，设置定位模式，可选的模式有高精度、仅设备、仅网络。默认为高精度模式</span></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"locationMode"</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (((<span class="keyword">int</span>)arguments.get(<span class="string">"locationMode"</span>)) == <span class="number">1</span>) &#123;</span><br><span class="line">        option.setLocationMode(LocationClientOption.LocationMode.Hight_Accuracy); <span class="comment">// 高精度模式</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (((<span class="keyword">int</span>)arguments.get(<span class="string">"locationMode"</span>)) == <span class="number">2</span>) &#123;</span><br><span class="line">        option.setLocationMode(LocationClientOption.LocationMode.Device_Sensors); <span class="comment">// 仅设备模式</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (((<span class="keyword">int</span>)arguments.get(<span class="string">"locationMode"</span>)) == <span class="number">3</span>) &#123;</span><br><span class="line">        option.setLocationMode(LocationClientOption.LocationMode.Battery_Saving); <span class="comment">// 仅网络模式</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可选，设置场景定位参数，包括签到场景、运动场景、出行场景</span></span><br><span class="line">    <span class="keyword">if</span> ((arguments.containsKey(<span class="string">"LocationPurpose"</span>))) &#123;</span><br><span class="line">      isPurporseLoc = <span class="keyword">true</span>;</span><br><span class="line">      <span class="keyword">if</span>  (((<span class="keyword">int</span>)arguments.get(<span class="string">"LocationPurpose"</span>)) == <span class="number">1</span>) &#123;</span><br><span class="line">        option.setLocationPurpose(LocationClientOption.BDLocationPurpose.SignIn); <span class="comment">// 签到场景</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (((<span class="keyword">int</span>)arguments.get(<span class="string">"LocationPurpose"</span>)) == <span class="number">2</span>) &#123;</span><br><span class="line">        option.setLocationPurpose(LocationClientOption.BDLocationPurpose.Transport); <span class="comment">// 运动场景</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (((<span class="keyword">int</span>)arguments.get(<span class="string">"LocationPurpose"</span>)) == <span class="number">3</span>) &#123;</span><br><span class="line">        option.setLocationPurpose(LocationClientOption.BDLocationPurpose.Sport); <span class="comment">// 出行场景</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      isPurporseLoc = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可选，设置需要返回海拔高度信息</span></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"isNeedAltitude"</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (((<span class="keyword">boolean</span>)arguments.get(<span class="string">"isNeedAltitude"</span>))) &#123;</span><br><span class="line">        option.setIsNeedAddress(<span class="keyword">true</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        option.setIsNeedAltitude(<span class="keyword">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可选，设置是否使用gps，默认false</span></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"openGps"</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span>(((<span class="keyword">boolean</span>)arguments.get(<span class="string">"openGps"</span>))) &#123;</span><br><span class="line">        option.setOpenGps(<span class="keyword">true</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        option.setOpenGps(<span class="keyword">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可选，设置是否允许返回逆地理地址信息，默认是true</span></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"isNeedLocationDescribe"</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span>(((<span class="keyword">boolean</span>)arguments.get(<span class="string">"isNeedLocationDescribe"</span>))) &#123;</span><br><span class="line">        option.setIsNeedLocationDescribe(<span class="keyword">true</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        option.setIsNeedLocationDescribe(<span class="keyword">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可选，设置发起定位请求的间隔，int类型，单位ms</span></span><br><span class="line">    <span class="comment">// 如果设置为0，则代表单次定位，即仅定位一次，默认为0</span></span><br><span class="line">    <span class="comment">// 如果设置非0，需设置1000ms以上才有效</span></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"scanspan"</span>)) &#123;</span><br><span class="line">      option.setScanSpan((<span class="keyword">int</span>)arguments.get(<span class="string">"scanspan"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 可选，设置返回经纬度坐标类型，默认GCJ02</span></span><br><span class="line">    <span class="comment">// GCJ02：国测局坐标；</span></span><br><span class="line">    <span class="comment">// BD09ll：百度经纬度坐标；</span></span><br><span class="line">    <span class="comment">// BD09：百度墨卡托坐标；</span></span><br><span class="line">    <span class="comment">// 海外地区定位，无需设置坐标类型，统一返回WGS84类型坐标</span></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"coorType"</span>)) &#123;</span><br><span class="line">      option.setCoorType((String)arguments.get(<span class="string">"coorType"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置是否需要返回附近的poi列表</span></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"isNeedLocationPoiList"</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (((<span class="keyword">boolean</span>)arguments.get(<span class="string">"isNeedLocationPoiList"</span>))) &#123;</span><br><span class="line">        option.setIsNeedLocationPoiList(<span class="keyword">true</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        option.setIsNeedLocationPoiList(<span class="keyword">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 设置是否需要最新版本rgc数据</span></span><br><span class="line">    <span class="keyword">if</span> (arguments.containsKey(<span class="string">"isNeedNewVersionRgc"</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (((<span class="keyword">boolean</span>)arguments.get(<span class="string">"isNeedNewVersionRgc"</span>))) &#123;</span><br><span class="line">        option.setIsNeedLocationPoiList(<span class="keyword">true</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        option.setIsNeedLocationPoiList(<span class="keyword">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="编写启动、停止功能"><a href="#编写启动、停止功能" class="headerlink" title="编写启动、停止功能"></a>编写启动、停止功能</h4><ul>
<li>开始定位</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startLocation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">null</span> != mLocationClient) &#123;</span><br><span class="line">    mLocationClient.start();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>停止定位</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">stopLocation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">null</span> != mLocationClient) &#123;</span><br><span class="line">    mLocationClient.stop();</span><br><span class="line">    mLocationClient = <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="百度定位回调"><a href="#百度定位回调" class="headerlink" title="百度定位回调"></a>百度定位回调</h4><ul>
<li>CurrentLocationListener</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 格式化时间</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> time</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> strPattern</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">formatUTC</span><span class="params">(<span class="keyword">long</span> time, String strPattern)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (TextUtils.isEmpty(strPattern)) &#123;</span><br><span class="line">      strPattern = <span class="string">"yyyy-MM-dd HH:mm:ss"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    SimpleDateFormat sdf = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      sdf = <span class="keyword">new</span> SimpleDateFormat(strPattern, Locale.CHINA);</span><br><span class="line">      sdf.applyPattern(strPattern);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sdf == <span class="keyword">null</span> ? <span class="string">"NULL"</span> : sdf.format(time);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">CurrentLocationListener</span> <span class="keyword">extends</span> <span class="title">BDAbstractLocationListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceiveLocation</span><span class="params">(BDLocation bdLocation)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">null</span> == mEventSink) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      Map&lt;String, Object&gt; result = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 判断国内外获取结果</span></span><br><span class="line">      <span class="keyword">if</span> (isInChina) &#123;</span><br><span class="line">        <span class="keyword">if</span> (bdLocation.getLocationWhere() == BDLocation.LOCATION_WHERE_IN_CN) &#123;</span><br><span class="line">          result.put(<span class="string">"isInChina"</span>, <span class="number">1</span>); <span class="comment">// 在国内</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          result.put(<span class="string">"isInChina"</span>, <span class="number">0</span>); <span class="comment">// 在国外</span></span><br><span class="line">        &#125;</span><br><span class="line">        mEventSink.success(result);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 场景定位获取结果</span></span><br><span class="line">      <span class="keyword">if</span> (isPurporseLoc) &#123;</span><br><span class="line">        result.put(<span class="string">"latitude"</span>, bdLocation.getLatitude()); <span class="comment">// 纬度</span></span><br><span class="line">        result.put(<span class="string">"longitude"</span>, bdLocation.getLongitude()); <span class="comment">// 经度</span></span><br><span class="line">        mEventSink.success(result);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      result.put(<span class="string">"callbackTime"</span>, formatUTC(System.currentTimeMillis(), <span class="string">"yyyy-MM-dd HH:mm:ss"</span>));</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">null</span> != bdLocation) &#123;</span><br><span class="line">        <span class="keyword">if</span> (bdLocation.getLocType() == BDLocation.TypeGpsLocation</span><br><span class="line">                || bdLocation.getLocType() == BDLocation.TypeNetWorkLocation</span><br><span class="line">                || bdLocation.getLocType() == BDLocation.TypeOffLineLocation) &#123;</span><br><span class="line">          result.put(<span class="string">"locType"</span>, bdLocation.getLocType()); <span class="comment">// 定位结果类型</span></span><br><span class="line">          result.put(<span class="string">"locTime"</span>, bdLocation.getTime()); <span class="comment">// 定位成功时间</span></span><br><span class="line">          result.put(<span class="string">"latitude"</span>, bdLocation.getLatitude()); <span class="comment">// 纬度</span></span><br><span class="line">          result.put(<span class="string">"longitude"</span>, bdLocation.getLongitude()); <span class="comment">// 经度</span></span><br><span class="line">          <span class="keyword">if</span> (bdLocation.hasAltitude()) &#123;</span><br><span class="line">            result.put(<span class="string">"altitude"</span>, bdLocation.getAltitude()); <span class="comment">// 高度</span></span><br><span class="line">          &#125;</span><br><span class="line">          result.put(<span class="string">"radius"</span>, Double.parseDouble(String.valueOf(bdLocation.getRadius()))); <span class="comment">// 定位精度</span></span><br><span class="line">          result.put(<span class="string">"country"</span>, bdLocation.getCountry()); <span class="comment">// 国家</span></span><br><span class="line">          result.put(<span class="string">"province"</span>, bdLocation.getProvince()); <span class="comment">// 省份</span></span><br><span class="line">          result.put(<span class="string">"city"</span>, bdLocation.getCity()); <span class="comment">// 城市</span></span><br><span class="line">          result.put(<span class="string">"district"</span>, bdLocation.getDistrict()); <span class="comment">// 区域</span></span><br><span class="line">          result.put(<span class="string">"town"</span>, bdLocation.getTown()); <span class="comment">// 城镇</span></span><br><span class="line">          result.put(<span class="string">"street"</span>, bdLocation.getStreet()); <span class="comment">// 街道</span></span><br><span class="line">          result.put(<span class="string">"address"</span>, bdLocation.getAddrStr()); <span class="comment">// 地址</span></span><br><span class="line">          result.put(<span class="string">"locationDetail"</span>, bdLocation.getLocationDescribe()); <span class="comment">// 位置语义化描述</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="keyword">null</span> != bdLocation.getPoiList() &amp;&amp; !bdLocation.getPoiList().isEmpty()) &#123;</span><br><span class="line"></span><br><span class="line">            List&lt;Poi&gt; pois = bdLocation.getPoiList();</span><br><span class="line">            StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (pois.size() == <span class="number">1</span>) &#123;</span><br><span class="line">              stringBuilder.append(pois.get(<span class="number">0</span>).getName()).append(<span class="string">","</span>).append(pois.get(<span class="number">0</span>).getTags())</span><br><span class="line">                      .append(pois.get(<span class="number">0</span>).getAddr());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; pois.size() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                stringBuilder.append(pois.get(i).getName()).append(<span class="string">","</span>).append(pois.get(i).getTags())</span><br><span class="line">                        .append(pois.get(i).getAddr()).append(<span class="string">"|"</span>);</span><br><span class="line">              &#125;</span><br><span class="line">              stringBuilder.append(pois.get(pois.size()-<span class="number">1</span>).getName()).append(<span class="string">","</span>).append(pois.get(pois.size()-<span class="number">1</span>).getTags())</span><br><span class="line">                      .append(pois.get(pois.size()-<span class="number">1</span>).getAddr());</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            result.put(<span class="string">"poiList"</span>,stringBuilder.toString()); <span class="comment">// 周边poi信息</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (bdLocation.getFloor() != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 当前支持高精度室内定位</span></span><br><span class="line">            String buildingID = bdLocation.getBuildingID();<span class="comment">// 百度内部建筑物ID</span></span><br><span class="line">            String buildingName = bdLocation.getBuildingName();<span class="comment">// 百度内部建筑物缩写</span></span><br><span class="line">            String floor = bdLocation.getFloor();<span class="comment">// 室内定位的楼层信息，如 f1,f2,b1,b2</span></span><br><span class="line">            StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">            stringBuilder.append(buildingID).append(<span class="string">"-"</span>).append(buildingName).append(<span class="string">"-"</span>).append(floor);</span><br><span class="line">            result.put(<span class="string">"indoor"</span>, stringBuilder.toString()); <span class="comment">// 室内定位结果信息</span></span><br><span class="line">            mLocationClient.startIndoorMode();<span class="comment">// 开启室内定位模式（重复调用也没问题），开启后，定位SDK会融合各种定位信息（GPS,WI-FI，蓝牙，传感器等）连续平滑的输出定位结果；</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            mLocationClient.stopIndoorMode(); <span class="comment">// 处于室外则关闭室内定位模式</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          result.put(<span class="string">"errorCode"</span>, bdLocation.getLocType()); <span class="comment">// 定位结果错误码</span></span><br><span class="line">          result.put(<span class="string">"errorInfo"</span>, bdLocation.getLocTypeDescription()); <span class="comment">// 定位失败描述信息</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        result.put(<span class="string">"errorCode"</span>, -<span class="number">1</span>);</span><br><span class="line">        result.put(<span class="string">"errorInfo"</span>, <span class="string">"location is null"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      mEventSink.success(result); <span class="comment">// android端实时检测位置变化，将位置结果发送到flutter端</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h4 id="位置提醒服务"><a href="#位置提醒服务" class="headerlink" title="位置提醒服务"></a>位置提醒服务</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyNotifyLister</span> <span class="keyword">extends</span> <span class="title">BDNotifyListener</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 已到达设置监听位置附近</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNotify</span><span class="params">(BDLocation mlocation, <span class="keyword">float</span> distance)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> == mEventSink) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Map&lt;String, Object&gt; result = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line">    result.put(<span class="string">"nearby"</span>, <span class="string">"已到达设置监听位置附近"</span>); <span class="comment">// 1为已经到达 0为未到达</span></span><br><span class="line">    mEventSink.success(result);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Flutter-Example-动态授权"><a href="#Flutter-Example-动态授权" class="headerlink" title="Flutter Example 动态授权"></a>Flutter Example 动态授权</h4><ul>
<li>example/pubspec.yaml</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dependencies:</span></span><br><span class="line">  <span class="attr">flutter:</span></span><br><span class="line">    <span class="attr">sdk:</span> <span class="string">flutter</span></span><br><span class="line"></span><br><span class="line">  <span class="string">...</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">permission_handler:</span> <span class="string">^5.0.1+1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>example/lib/main.dart</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动态申请定位权限</span></span><br><span class="line">Future&lt;<span class="built_in">bool</span>&gt; _requestPermission() <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="built_in">Map</span>&lt;Permission, PermissionStatus&gt; statuses = <span class="keyword">await</span> [</span><br><span class="line">    Permission.location,</span><br><span class="line">    Permission.storage,</span><br><span class="line">  ].request();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> statuses[Permission.location].isGranted &amp;&amp;</span><br><span class="line">      statuses[Permission.storage].isGranted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Flutter-Example-调用组件-API"><a href="#Flutter-Example-调用组件-API" class="headerlink" title="Flutter Example 调用组件 API"></a>Flutter Example 调用组件 API</h4><ul>
<li>example/lib/main.dart</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyAppState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyApp</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 组件对象</span></span><br><span class="line">  FlutterBaiduPluginDucafecat _locationPlugin = FlutterBaiduPluginDucafecat();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 定义成员变量</span></span><br><span class="line">  StreamSubscription&lt;<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">Object</span>&gt;&gt; _locationListener; <span class="comment">// 事件监听</span></span><br><span class="line">  BaiduLocation _baiduLocation; <span class="comment">// 经纬度信息</span></span><br><span class="line">  <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">Object</span>&gt; _loationResult; <span class="comment">// 返回格式数据</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    _requestPermission(); <span class="comment">// 执行权限请求</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">    <span class="comment">// 取消监听</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> != _locationListener) &#123;</span><br><span class="line">      _locationListener.cancel();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 动态申请定位权限</span></span><br><span class="line">  Future&lt;<span class="built_in">bool</span>&gt; _requestPermission() <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="built_in">Map</span>&lt;Permission, PermissionStatus&gt; statuses = <span class="keyword">await</span> [</span><br><span class="line">      Permission.location,</span><br><span class="line">      Permission.storage,</span><br><span class="line">    ].request();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> statuses[Permission.location].isGranted &amp;&amp;</span><br><span class="line">        statuses[Permission.storage].isGranted;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 返回定位信息</span></span><br><span class="line">  <span class="keyword">void</span> _setupListener() &#123;</span><br><span class="line">    <span class="keyword">if</span> (_locationListener != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    _locationListener =</span><br><span class="line">        _locationPlugin.onResultCallback().listen((<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">Object</span>&gt; result) &#123;</span><br><span class="line">      setState(() &#123;</span><br><span class="line">        _loationResult = result;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          _baiduLocation = BaiduLocation.fromMap(result);</span><br><span class="line">          <span class="built_in">print</span>(_baiduLocation);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          <span class="built_in">print</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置android端和ios端定位参数</span></span><br><span class="line">  <span class="keyword">void</span> _setLocOption() &#123;</span><br><span class="line">    <span class="comment">// android 端设置定位参数</span></span><br><span class="line">    BaiduLocationAndroidOption androidOption = <span class="keyword">new</span> BaiduLocationAndroidOption();</span><br><span class="line">    androidOption.setCoorType(<span class="string">"bd09ll"</span>); <span class="comment">// 设置返回的位置坐标系类型</span></span><br><span class="line">    androidOption.setIsNeedAltitude(<span class="keyword">true</span>); <span class="comment">// 设置是否需要返回海拔高度信息</span></span><br><span class="line">    androidOption.setIsNeedAddres(<span class="keyword">true</span>); <span class="comment">// 设置是否需要返回地址信息</span></span><br><span class="line">    androidOption.setIsNeedLocationPoiList(<span class="keyword">true</span>); <span class="comment">// 设置是否需要返回周边poi信息</span></span><br><span class="line">    androidOption.setIsNeedNewVersionRgc(<span class="keyword">true</span>); <span class="comment">// 设置是否需要返回最新版本rgc信息</span></span><br><span class="line">    androidOption.setIsNeedLocationDescribe(<span class="keyword">true</span>); <span class="comment">// 设置是否需要返回位置描述</span></span><br><span class="line">    androidOption.setOpenGps(<span class="keyword">true</span>); <span class="comment">// 设置是否需要使用gps</span></span><br><span class="line">    androidOption.setLocationMode(LocationMode.Hight_Accuracy); <span class="comment">// 设置定位模式</span></span><br><span class="line">    androidOption.setScanspan(<span class="number">1000</span>); <span class="comment">// 设置发起定位请求时间间隔</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">Map</span> androidMap = androidOption.getMap();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ios 端设置定位参数</span></span><br><span class="line">    BaiduLocationIOSOption iosOption = <span class="keyword">new</span> BaiduLocationIOSOption();</span><br><span class="line">    iosOption.setIsNeedNewVersionRgc(<span class="keyword">true</span>); <span class="comment">// 设置是否需要返回最新版本rgc信息</span></span><br><span class="line">    iosOption.setBMKLocationCoordinateType(</span><br><span class="line">        <span class="string">"BMKLocationCoordinateTypeBMK09LL"</span>); <span class="comment">// 设置返回的位置坐标系类型</span></span><br><span class="line">    iosOption.setActivityType(<span class="string">"CLActivityTypeAutomotiveNavigation"</span>); <span class="comment">// 设置应用位置类型</span></span><br><span class="line">    iosOption.setLocationTimeout(<span class="number">10</span>); <span class="comment">// 设置位置获取超时时间</span></span><br><span class="line">    iosOption.setDesiredAccuracy(<span class="string">"kCLLocationAccuracyBest"</span>); <span class="comment">// 设置预期精度参数</span></span><br><span class="line">    iosOption.setReGeocodeTimeout(<span class="number">10</span>); <span class="comment">// 设置获取地址信息超时时间</span></span><br><span class="line">    iosOption.setDistanceFilter(<span class="number">100</span>); <span class="comment">// 设置定位最小更新距离</span></span><br><span class="line">    iosOption.setAllowsBackgroundLocationUpdates(<span class="keyword">true</span>); <span class="comment">// 是否允许后台定位</span></span><br><span class="line">    iosOption.setPauseLocUpdateAutomatically(<span class="keyword">true</span>); <span class="comment">//  定位是否会被系统自动暂停</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">Map</span> iosMap = iosOption.getMap();</span><br><span class="line"></span><br><span class="line">    _locationPlugin.prepareLoc(androidMap, iosMap);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 启动定位</span></span><br><span class="line">  <span class="keyword">void</span> _startLocation() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> != _locationPlugin) &#123;</span><br><span class="line">      _setupListener();</span><br><span class="line">      _setLocOption();</span><br><span class="line">      _locationPlugin.startLocation();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 停止定位</span></span><br><span class="line">  <span class="keyword">void</span> _stopLocation() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> != _locationPlugin) &#123;</span><br><span class="line">      _locationPlugin.stopLocation();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      home: Scaffold(</span><br><span class="line">        appBar: AppBar(title: Text(<span class="string">'地图插件'</span>)),</span><br><span class="line">        body: Center(</span><br><span class="line">          child: Column(</span><br><span class="line">            children: &lt;Widget&gt;[</span><br><span class="line">              FlatButton(</span><br><span class="line">                onPressed: _startLocation,</span><br><span class="line">                child: Text(<span class="string">'开始定位'</span>),</span><br><span class="line">              ),</span><br><span class="line">              FlatButton(</span><br><span class="line">                onPressed: _stopLocation,</span><br><span class="line">                child: Text(<span class="string">'暂停定位'</span>),</span><br><span class="line">              )</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><hr>
<p>© 猫哥</p>
<p><a href="https://ducafecat.tech/">https://ducafecat.tech</a></p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        

        
        邮箱 ducafecat@gmail.com / 微信 ducafecat / 留言板 disqus
        
    </div>
    
    <footer>
        <a href="https://ducafecat.tech">
            <img src="/img/avatar.jpg" alt="猫哥">
            猫哥
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flutter/">flutter</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/&title=《Flutter 混合开发 - 02 百度地图定位功能 android 篇》 — duCafeCat&pic=https://ducafecat.tech/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/&title=《Flutter 混合开发 - 02 百度地图定位功能 android 篇》 — duCafeCat&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Flutter 混合开发 - 02 百度地图定位功能 android 篇》 — duCafeCat&url=https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/&via=https://ducafecat.tech" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="waves-block waves-effect next">
      <a href="/2020/07/30/flutter-daily/flutter-plugins-01-developing-packages-plugins/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Flutter 混合开发 - 01 编写设备端组件的正确姿势!</h4>
      </a>
    </div>
  
</nav>



    

















</article>


</div>

        <footer class="footer">
    <div class="top">
        

        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>猫哥 &copy; 2018 - 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/&title=《Flutter 混合开发 - 02 百度地图定位功能 android 篇》 — duCafeCat&pic=https://ducafecat.tech/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/&title=《Flutter 混合开发 - 02 百度地图定位功能 android 篇》 — duCafeCat&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Flutter 混合开发 - 02 百度地图定位功能 android 篇》 — duCafeCat&url=https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/&via=https://ducafecat.tech" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ducafecat.tech/2020/08/04/flutter-daily/flutter-plugins-02-baidu-map-android/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAADOElEQVR42u3awY7iQAwEUP7/p9nrSgtMlZvREvNyGjEh6dccSrb7douv+1/X7L+v7/z3nmf3359ct9+4sLGxsS/Cvr+88mXly80BJ+/9YWuwsbGx17GT4EkSIX/m6wh8tgX51vzwXmxsbOwvZicFwCzM8vuxsbGxsWfstlTIwy8pTv5bgGFjY2NfhN2+8nWpkJQceZNots639dKwsbGxP56dR8vn//0r821sbGzsD2bfyysPpLZ5dMKrFdjY2NiL2LMjO+34Nv9W297Kh8EPno+NjY29gt2ObNtP2rbOe4cQUW5jY2NjL2LPCo+2QZ9HXfLM/GgRNjY29m72LHhyWNtySmKsHWY8qL2wsbGxV7DbllBeWtxH1+/9GEedMGxsbOwPZreD2JPhQR5ys23KW1fY2NjYW9ltLLUNnZNy4uRI6IOVY2NjYy9lz6jDBn3QVEraQ/md0TwZGxsb+7LsWdtoduxmNgBIPq8DDBsbG3sFe3YgJo+KhPfeAqb4CbGxsbFXsPMXnJcNs0KoLYqi8MPGxsb+AnY+7k0Ssv1uUqLMVvV0PICNjY19WXZbMCQvmzXu261vRxEPtg8bGxt7BfukhdTGRo5v76+fiY2Njb2OnQxKZ8udLe7k6E+0cmxsbOx17OTWWalwfuCmHSpHb8HGxsZex84f0bZvilA5iMk6MrGxsbEXsdvmUd42asuMZOvzDYp+QmxsbOyl7GRBJzGWFzazdRajX2xsbOwV7PxBbeS0Tz7ZoDxEb7PFYWNjY38wOw+kPKjaRk+76HcNkrGxsbE3sdvmUT6snS3opLzJn4ONjY29iZ23kNrAmx3NzIcEbQsMGxsbeyu7JbUDg7bAyMcD7RD6QSmCjY2NvYid89pio42iJFbzddZNJWxsbOxLse/llR95rPd+dEhoWOpgY2NjL2LPFnrSHkrKnnybZmNgbGxs7H3sk6FpvhHJc2YtqvY4ETY2NvZWdhIMs9b/ySB5mLdJyYSNjY399eyTYGvjLS9miqYVNjY29hezk0hLjuPk44eTcW9xUgkbGxv74uzz4W47PHjXNTzig42Njb2InTdoZiPbk+Khjb12zdjY2NgXZ/8BRokDvo5VdVUAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


lazyScripts.push('//s22.cnzz.com/z_stat.php?id=1274928662&web_id=1274928662')

</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>



<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" async></script>








</body>
</html>
